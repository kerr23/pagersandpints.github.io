<!DOCTYPE html>
<html lang="en">
<head>
  
    <title>Create a backup manifest in PostgreSQL with oid2name :: Pagers and Pints — DevOps, SRE and Beer</title>
  
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta name="description" content="oid2name is a nifty little program comes with postgresql an it allows you to take those obscure relfilenode named datafiles at the OS level and map them to database objects.
The only downside to this little tool is that it doesn&amp;rsquo;t exactly work when your database is down since it uses pg_* to figure out this info. So if you&amp;rsquo;re in a situation where you&amp;rsquo;re restoring the database and find out that you&amp;rsquo;re missing a file from the backup - you may want to know what table is lost."/>
<meta name="keywords" content="DevOps, SRE, Site Reliability, Pager"/>
<meta name="robots" content="noodp"/>
<link rel="canonical" href="../../posts/create-a-backup-manifest-in-postgresql-with-oid2name/" />


<link rel="stylesheet" href="../../assets/style.css">

  <link rel="stylesheet" href="../../assets/green.css">



<link rel="stylesheet" href="../../style.css">


<link rel="apple-touch-icon-precomposed" sizes="144x144" href="../../img/apple-touch-icon-144-precomposed.png">

<link rel="shortcut icon" href="../../img/favicon/green.png">



<meta name="twitter:card" content="summary" />
<meta name="twitter:title" content="Create a backup manifest in PostgreSQL with oid2name :: Pagers and Pints — DevOps, SRE and Beer" />
<meta name="twitter:description" content="oid2name is a nifty little program comes with postgresql an it allows you to take those obscure relfilenode named datafiles at the OS level and map them to database objects.
The only downside to this little tool is that it doesn&amp;rsquo;t exactly work when your database is down since it uses pg_* to figure out this info. So if you&amp;rsquo;re in a situation where you&amp;rsquo;re restoring the database and find out that you&amp;rsquo;re missing a file from the backup - you may want to know what table is lost." />
<meta name="twitter:site" content="/" />
<meta name="twitter:creator" content="Dave Kerr" />
<meta name="twitter:image" content="">


<meta property="og:locale" content="en" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Create a backup manifest in PostgreSQL with oid2name :: Pagers and Pints — DevOps, SRE and Beer">
<meta property="og:description" content="oid2name is a nifty little program comes with postgresql an it allows you to take those obscure relfilenode named datafiles at the OS level and map them to database objects.
The only downside to this little tool is that it doesn&amp;rsquo;t exactly work when your database is down since it uses pg_* to figure out this info. So if you&amp;rsquo;re in a situation where you&amp;rsquo;re restoring the database and find out that you&amp;rsquo;re missing a file from the backup - you may want to know what table is lost." />
<meta property="og:url" content="/posts/create-a-backup-manifest-in-postgresql-with-oid2name/" />
<meta property="og:site_name" content="Create a backup manifest in PostgreSQL with oid2name" />
<meta property="og:image" content="">
<meta property="og:image:width" content="2048">
<meta property="og:image:height" content="1024">

<meta property="article:published_time" content="2012-06-07 05:02:00 &#43;0000 UTC" />











</head>
<body class="">


<div class="container">

  <header class="header">
  <div class="header__inner">
    <div class="header__logo">
      <a href="../../">
  <div class="logo">
    Pagers and Pints
  </div>
</a>

    </div>
    <div class="menu-trigger">menu</div>
  </div>
  
</header>


  <div class="content">
    
<div class="post">
  <h1 class="post-title">
    <a href="../../posts/create-a-backup-manifest-in-postgresql-with-oid2name/">Create a backup manifest in PostgreSQL with oid2name</a></h1>
  <div class="post-meta">
    <span class="post-date">
      2012-06-07
    </span>
    
    <span class="post-author">::
      Dave Kerr
    </span>
    
  </div>

  
  <span class="post-tags">
    
    #<a href="../../tags/postgresql/">PostgreSQL</a>&nbsp;
    
  </span>
  

  

  <div class="post-content">
    <p><a href="http://www.postgresql.org/docs/current/static/oid2name.html">oid2name</a> is a nifty little program comes with postgresql an it allows you to take those obscure relfilenode named datafiles at the OS level and map them to database objects.</p>

<p>The only downside to this little tool is that it doesn&rsquo;t exactly work when your database is down since it uses pg_* to figure out this info. So if you&rsquo;re in a situation where you&rsquo;re restoring the database and find out that you&rsquo;re missing a file from the backup - you may want to know what table is lost.</p>

<p>If you thought ahead and have a manifest.txt in your backups you&rsquo;ll be able to see that the following maps to pgbench_accounts</p>

<p><code>-rw------- 1 postgres postgres 13434880 Jun  7 04:44 /db/9.1/data/base/1952441/1952454</code></p>

<p>If you use the -ix flag you get schema, OID and tablespace. If you also add the -S flag you get all the system tables too which is very important in a recovery situation.</p>

<p><code>/usr/pgsql-9.1/bin/oid2name -ix -d pgbench</code>
From database &ldquo;pgbench&rdquo;:</p>

<pre><code>  Filenode             Table Name      Oid  Schema  Tablespace  
--------------------------------------------------------------
   1952454       pgbench_accounts  1952448  public  pg_default  
   1952459  pgbench_accounts_pkey  1952459  public  pg_default  
   1952442       pgbench_branches  1952442  public  pg_default  
   1952455  pgbench_branches_pkey  1952455  public  pg_default  
   1952451        pgbench_history  1952451  public  pg_default  
   1952445        pgbench_tellers  1952445  public  pg_default  
   1952457   pgbench_tellers_pkey  1952457  public  pg_default
</code></pre>

  </div>
  
  <div class="pagination">
    <div class="pagination__title">
      <span
        class="pagination__title-h">Read other posts</span>
      <hr />
    </div>
    <div class="pagination__buttons">
      
      <span class="button previous">
        <a href="../../posts/psql-reverse-search-history/">
          <span class="button__icon">←</span>
          <span class="button__text">psql - reverse search history</span>
        </a>
      </span>
      
      
      <span class="button next">
        <a href="../../posts/a-script-to-see-row-counts-and-table-size-in-postgresql/">
          <span class="button__text">A script to see row counts and table size in PostgreSQL</span>
          <span class="button__icon">→</span>
        </a>
      </span>
      
    </div>
  </div>
  

  

</div>

  </div>

  
    <footer class="footer">
  <div class="footer__inner">
    
      <div class="copyright">
        <span>© 2019 Powered by <a href="http://gohugo.io">Hugo</a></span>
        <span>:: Theme made by <a href="https://twitter.com/panr">panr</a></span>
      </div>
    
  </div>
</footer>

<script src="../../assets/main.js"></script>
<script src="../../assets/prism.js"></script>





  
</div>

</body>
</html>
